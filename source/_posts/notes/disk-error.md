---
title: PC维修记
categories:
  - notes
tags:
  - lenovo
date: 2017-10-11 15:26:47
toc: true
---
国庆放假带电脑回家，一为值班，二为娱乐。结果到家开机就发现进不去系统了，后面就开始漫长的维修经历。按照时间先后顺序记录如下：

电脑品牌：Lenovo
操作系统：win7 专业版

<!-- more -->

# 问题发生
坐高铁回家的上午，临时拷贝了一些东西到移动硬盘。拷贝完成准备关机时，发现电脑进入到360的更新系统的状态，并标识请勿关闭电源。等了一会儿，发现进度根本不动，所以点了取消，系统变为取消中……，之后就卡在这个界面。由于赶时间，关上了屏幕，拔掉了电源。

到家后，开机。发现启动特别慢，windows的四色图标大概话了20~30分钟才出现，意识到可能出问题了。好不容易挨到输入账号密码的页面，输入密码后，经历了大概又30min的等待，出现了第一个报错：  

![](/images/userprofile.jpg)

# 解决问题
## 问题1：user profile service服务未能登录

尝试解决：  
* 正常无法登录时，首先选择使用“安全模式”尝试登录，耗费大量时间后成功登入系统。发现系统卡顿到不行，一次邮件操作大概需要10min左右的反馈时间。
> 平时也会选择使用“最后一次正确的配置”来登录。本次用1h的时间证明失败

* 能够成功进入到安全模式后，面临两种选择：1.修复原账户；2.创建新账户。可以二者结合进行。由于安全模式过于卡顿，所以创建了一个新账户。然后重新启动。

* 进入系统依然很慢，但是好在通过新账户可以进入到系统。但是出现和安全模式一样的问题，十分卡顿。尝试通过注册表修复原账户，网上介绍的方法如下,简单来说就是注册表中会对账户信息做一个备份，把当前问题账户的记录删除，使用对应的备份记录替代。
>进入下列注册表项HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProfileList您在左边的画面会看到两个类似的文件夹，类似“S-1-5-21-xxxxx & S-1-5-21xxxxx”和“S-1-5-21-xxxxx & S-1-5-21xxxxx.bak”，将不带.bak的注册表文件夹重命名为xxx.bak.old，然后将.bak的注册表文件夹恢复成原来正常的名字，如“S-1-5-21-xxxxx & S-1-5-21xxxxx”，重启电脑即可恢复正常

* 操作后重启，进入原账户，问题依然。既然新账户能登陆，干脆把需要的内容备份后，把老账户干掉算了。操作后，新账户可以慢……慢……慢……登录到系统了。问题暂时解决。

到目前为止，虽然可以进入到系统。但是1h的开机时间，10min的操作反馈时间无法容忍。于是开始解决第二个问题。

## 问题2：电脑卡顿

尝试解决：
* 卡顿一般可能是内存不足导致的。但经过Lenovo在系统启动时自带的硬件自检程序，证明了内存无异常。排除了这个问题。
* 通过系统日志中查看，发现有大量的报错：“设备 \Device\Ide\IdePort2 没有在传输等待时间内响应”：

![](/images/device.jpg)
* 从报错上看应该是硬盘有点问题，于是运行了磁盘检查。由于当前正在使用，所以系统告知我关机后会自动检查。

进行了很长时间的检查后，看到有坏道被监测出。待检查完毕，重新开机修复坏道时，发现无法进入系统了，报错：

![](/images/disk_error.png)

## 问题3：a disk read error occurred
尝试解决：
* MD，现在连系统都进不去了，还怎么解决……
* 突然发现Lenovo 自带了 Lenovo Diagnostics工具，可以进行硬盘检测和修复
* 长达6h的检测和修复后，发现问题照旧……
* 鉴于之前新账户是可以登录系统的，感觉是C盘的硬盘有问题，其它磁盘应该还好。所以打算把C盘格式化后重装下。

## 最终解决：
1. 制作U盘启动，进入PE，发现C盘和D盘都无法识别，其它盘正常。
2. 格式化C盘、D盘后，使用恢复文件工具把需要的文件都救了回来
3. 之前有做过系统备份，从镜像中重装了系统。

重装后，系统正常。问题解决……

>Tips:重装了系统后，首先安装了360安全卫士。上次我没有听你的话，是我错了……
