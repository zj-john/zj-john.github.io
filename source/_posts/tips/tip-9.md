---
title: 正则表达式中(?:pattern)的含义
categories:
  - tips
tags:
  - tip
date: 2017-10-16 10:51:12
toc: true
---
> 问题：正则表达式中 (?:pattern)的含义

<!-- more -->

在看jQuery源码的时候，碰到"/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/"这个正则表达式，对其中的(?:pattern)不太明白。

[官网](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Guide/Regular_Expressions)解释如下：  
>(?:x)：   
匹配 'x' 但是不记住匹配项。这种叫作非捕获括号，使得你能够定义为与正则表达式运算符一起使用的子表达式。来看示例表达式 /(?:foo){1,2}/。如果表达式是 /foo{1,2}/，{1,2}将只对 ‘foo’ 的最后一个字符 ’o‘ 生效。如果使用非捕获括号，则{1,2}会匹配整个 ‘foo’ 单词。


?:是非捕获元之一.(?:)代表不捕获分组。比较(X)和(?:X)，前者是捕获分组，后者不捕获，区别在于正则表达式匹配输入字符串之后所获得的匹配的（数）组当中没有(?:X)匹配的部分；
```JavaScript
var m = "abcabc".match(/(?:a)(b)(c)/)
//结果 ["abc", "b", "c"]
// m[0] 是/(?:a)(b)(c)/匹配到的整个字符串，这里包括了a
// m[1] 是捕获组1，即(b)匹配的子字符串substring or sub sequence
// m[2] 是捕获组2，即(c)匹配到的

var m = "abcabc".match(/(a)(b)(c)/)
//结果 ["abc", "a", "b", "c"]
```

分析下这个正则表达式的作用：
```JavaScript
// 这个正则表达式是为了匹配selector：例如<html>、#id，且 id的优先级超过tag
var rquickExpr = /^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;

// /^、$/: 匹配头尾
// /^()$/ : （）：标记一个子表达式的开始和结束位置，但会有一个副作用，是相关的匹配会被缓存，所捕获的每个子匹配都按照在正则表达式模式中从左到右出现的顺序存储。缓冲区编号从 1 开始，最多可存储 99 个捕获的子表达式。每个缓冲区都可以使用 \n 访问，其中 n 为一个标识特定缓冲区的一位或两位十进制数。此时可用?:放在第一个选项前来消除这种副作用
// /^(?:)$/ :不捕获最外成括号的整体匹配
// \s*: 匹配空白字符0次或多次
// <[\w\W]+> : 匹配任意字符1次或者多次 ([]:匹配方括号(\w:匹配一个单字字符 \W:匹配一个非单字字符)
// [^>]*: 以>开头的任意字符0次或多次
// 以上匹配 tag 如<div> <li>test
// | 或
// 以下匹配id
// #([\w-]*): 匹配"#<string>"0次或多次

// 执行测试：
// rquickExpr.exec( selector );来执行
// 如果匹配成功，exec() 方法返回一个数组，并更新正则表达式对象的属性。返回的数组将完全匹配成功的文本作为第一项，将正则括号里匹配成功的作为数组填充到后面。
// 如果不加?: ，则每个数组的length为4
var selector = '<html>';
// ["<html>", "<html>", undefined]

var selector = '#id';
// ["#id", undefined, "id"]

var selector = '<html>#id';
// ["<html>#id", "<html>", undefined]

var selector = '<div>asdgasdg'
// ["<div>asdgasdg", "<div>", undefined]


```

另外还有两种非捕获元是 ?= 和 ?!.  
>x(?=y):  	
匹配'x'仅仅当'x'后面跟着'y'.这种叫做正向肯定查找。
例如，/Jack(?=Sprat)/会匹配到'Jack'仅仅当它后面跟着'Sprat'。/Jack(?=Sprat|Frost)/匹配‘Jack’仅仅当它后面跟着'Sprat'或者是‘Frost’。但是‘Sprat’和‘Frost’都不是匹配结果的一部分。


>x(?!y):  
匹配'x'仅仅当'x'后面不跟着'y',这个叫做正向否定查找。
例如，/\d+(?!\.)/匹配一个数字仅仅当这个数字后面没有跟小数点的时候。正则表达式/\d+(?!\.)/.exec("3.141")匹配‘141’但是不是‘3.141’
